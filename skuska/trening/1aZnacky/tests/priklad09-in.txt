3 1000 5
.....
a....
a..b.
..cb.
....c
.....
.....
....c
...ac
c..bc
b..bc
ab..c
bb...
bba.a
bba.c
bba.c
b.acc
b.bcc
b.bcc
b..bc
b..b.
b..b.
b..b.
...b.
.....
..b..
.bb..
.bb.a
abbaa
.bc..
..cb.
..cb.
..bb.
..bb.
..bb.
.abb.
.ab..
.ab..
cabc.
..bc.
..b.a
..b..
..b..
..b..
..bc.
..bc.
..bc.
..aca
bcaca
bbac.
b..c.
b.ac.
b.ab.
b.abc
..a.b
..a.c
..aab
..aab
.b.ab
.bbab
.cbab
ccba.
ccb..
ccb..
.cb..
.cbb.
...b.
...b.
.b.b.
.b.b.
.bcb.
.bc..
cac.a
ca..a
.a...
.a..c
.....
.b...
.....
.....
..a..
cba..
cbaa.
cbaa.
cb...
ca...
cc...
ca.a.
c.bb.
c.cb.
c.cb.
c..b.
c..b.
.....
.....
.c.b.
...b.
.....
a....
b..b.
c..b.
..bb.
..bbc
..bac
..bac
..bac
..b.c
.....
b....
a...a
a...a
cb...
c...c
....c
b...c
b...c
a....
ac...
.cbc.
.cbc.
..bc.
..b..
..b..
.bb..
.bab.
.b.c.
.b.c.
b..cc
...cc
....c
....b
..b.b
...ca
c..ca
ba.cb
babcb
cabcb
cabcb
bab.b
ba..b
.a..b
.a.bb
.a.cb
.a.cb
.a.cb
...cb
.caab
.c.ab
..ba.
babaa
babaa
.abaa
aabaa
.ab..
.ab..
.aba.
.aba.
.ab..
.ab..
.ab..
.a...
.ab..
.....
.....
.....
.....
c....
ab..c
ac..c
a...c
a..ca
ba.ca
aa.cc
.b.cc
.b.c.
a..c.
a.ac.
cbac.
cb.c.
.b...
.b..a
.b..a
.b..a
c.c.a
c.c..
c.c..
..ca.
.....
...b.
.....
.c...
a.a.c
a.acc
c.aca
cc.c.
ccac.
cc.ca
cacca
ca.ca
ca.ca
ca.ca
ca.ca
.b.ca
.b.c.
.a...
aa...
aa...
.a...
.a...
.a...
.a.a.
..bc.
...c.
.....
.a...
.a...
.a...
.a...
.a...
.ac..
bac.b
.aaa.
.cba.
cab..
cab..
.ab..
.aab.
.aab.
.aa.b
baa.b
baa.b
a.abb
abab.
ac.b.
ac.b.
ac...
ab...
ac...
ac...
ac...
ac..a
ac...
a....
aa...
aa...
aa.a.
aa.a.
aa.ab
a....
a....
bac.a
bac.a
ba...
ca..a
ca..a
caa.a
caa.a
c.aca
c.ac.
c.ac.
cbab.
.ba..
.ba..
.b...
.b...
.b...
.b.c.
.b...
.b...
.b...
cb...
cb...
.b...
.....
.....
.....
.c.c.
...ca
...ca
.....
...ca
...ca
c..ca
cb..a
cb...
cb...
ca...
aa...
.c.b.
.a.bb
.a.cb
.cacb
cbacb
cba..
c.bb.
c.bb.
cb.b.
..cb.
.bcb.
.b.c.
...b.
.....
bc.c.
bb.a.
bb...
bb...
bb.b.
.b..b
.b.a.
.c.ab
.cba.
c.aa.
b....
b....
b....
...bc
c..bc
....c
b...c
b...c
b.a.c
b...c
ba...
b....
b....
ba..b
ba..b
b....
b....
..c..
..c..
..c..
bbc..
bb..a
ba.cb
aac.a
aacca
.a.c.
.a.cc
.aacb
.aacb
.aac.
.aac.
..b..
.cb..
.cb..
.cbb.
.c...
.....
.....
.....
.....
...a.
...a.
.....
.....
.....
.....
..c..
..c..
..c..
cb..b
cc..b
cca.b
ccc.b
c.c.b
c.a.b
..ab.
.....
.ac..
.a...
ba...
ba..b
b...b
b....
a....
a....
b....
ba.b.
b..b.
b..b.
ba.b.
ba.ba
ba.ba
aa..b
ba..c
ba..c
b...c
..bac
..bbc
...bc
....c
.c..c
.c..c
bc..c
bcb.a
.c..a
.c...
bc...
bbca.
.b...
.b...
.b...
..bb.
..bbc
..b.c
..b.c
..b.a
cab.a
c.b.c
..b..
..ba.
.bba.
.b...
.b...
....a
...ba
....a
....a
....a
....a
...cb
...c.
...c.
....c
...bc
...b.
.....
b....
..b..
..b.a
..c.c
..c.c
a...a
b...a
b....
..c..
.bca.
.aca.
.aca.
.ab..
a.b..
c.b..
a.a..
a.a..
a.a..
c.a..
cbb..
cb...
cb...
cb...
c.c..
cac.b
cac.b
bac.b
bac.b
bc..b
.c..b
....b
....b
...ab
...a.
.c.a.
.c.a.
.c...
.c...
.....
.....
...a.
...ba
...ba
...ba
.abba
.a.ba
...cb
...cb
...ab
c..ab
c..ab
.c.ab
cc.a.
cc.a.
ac.a.
a..ab
a..ab
a..ab
.....
c.b..
c....
ca..c
.bc.c
.bc.a
.bc.a
.bc.a
.bc.a
.c..b
.c.cc
.c.cc
.c.cc
b..cc
b..aa
b.aaa
b.aca
b.aca
b..c.
b....
....a
aca.a
a.a.a
bba.a
bba.a
bb..a
bba.a
bba.a
bbb.a
bbbaa
.bb.a
..b.b
...cb
...c.
...cc
...cc
..ab.
.caa.
.c...
.c...
.c...
.ca.b
.ca.b
ccacb
cba.b
cba.b
.cc.b
..ba.
..b..
..b..
..ba.
..b..
..b..
..b..
b.b..
b.b..
bcb..
bcc..
bcca.
bcca.
bcca.
b.ca.
b.cac
..cac
..cab
....b
....b
....b
.a..b
.c..b
....b
....b
.....
.....
..c..
....c
ac..c
.c..c
.cccc
ccac.
c.a..
c.a..
c.a..
..a..
..a..
..a..
..a..
bbc.c
bbc.c
..c.b
..a.b
..a.b
.cc.b
.ac.b
.aa..
.ca..
.ca..
.ca..
.ca.c
.cb.b
ac...
.c.b.
bc.b.
ba..a
ba..a
bab.a
bcb.a
bcb.a
ccb.c
ccb.c
ccb.c
cc..c
cc..c
ac.bc
aa..b
aa..b
aa.cb
aa.ca
.ab.a
.acc.
..cc.
.ac..
.cca.
b.ca.
..ca.
c.ca.
..aa.
..ac.
...c.
...ab
..aab
..acb
..acb
c..cb
cb..b
cb..a
cb..a
cb..a
cc..a
cc...
cacb.
b..a.
b..ac
b..ac
....c
....c
.....
cac..
.ac..
..cca
ccc.a
ccc.a
ca...
.a...
.a...
.a...
.....
....a
..c.a
..caa
..c..
aac..
..c..
.....
....b
..c.b
..c..
..c..
..c..
c.cc.
c.cca
c.c..
c.c..
..caa
.a.a.
.a.a.
.a.cb
...ca
.a.cc
ca.ba
ca.bc
ca.ac
caaaa
cbaaa
.b..a
.b..a
cb..a
cb..c
ab..c
ab..c
ab..c
a...c
a...c
a..b.
...b.
...b.
...a.
...a.
aa.a.
a.aa.
a.aa.
a.ac.
b.ac.
a.bc.
a.bc.
a.bc.
a.bc.
a.bab
a.bab
a.ba.
..bc.
..bc.
a.b..
.cba.
.cba.
.c...
.c...
.c..b
..b.c
..b.c
ccb.c
ccb.c
ccb.c
..b.c
..bbc
..bb.
.cabb
.cab.
.cab.
.c.b.
.c.bc
...ac
.abac
.aaac
.abba
..cca
..cca
..cca
b..ca
bb.ca
bb.ca
b.b..
..cac
....c
...ac
.....
.....
aac..
aac..
aac..
..a.c
aaaac
aaaac
..aac
.a.ac
.a.ac
....c
....c
....c
.c.ab
.c.ab
.a.ca
...cb
....b
..a.b
.ba.b
cb..b
caa.b
aaa..
aaa..
.....
..b..
.cb..
.abc.
.abc.
a.bc.
a.bc.
abca.
abcab
acaaa
acaaa
ccaca
aaaca
aaac.
a.ac.
a.ac.
a..c.
a.c..
a....
...c.
....c
....c
.....
..ab.
.a.b.
aa.b.
.a...
.c..a
.c...
.bc..
.bc..
.bc..
ab.b.
.b.ca
.b.ca
.bacc
.bccc
.b.cc
.bb.a
..b.a
..b.a
..b.a
....a
.b.ca
...ca
....a
...ba
...bc
..bbc
..bbc
c.c.c
..a.c
.bacc
.baac
.baac
.baac
.b.ac
.b.ac
.bca.
.b.ca
.b.ca
.c.c.
.ccc.
.bccc
cbcc.
.bcca
.bc.a
.bc.a
.b..c
.ba.c
.bacc
..acc
..a.c
c.a.c
c.a..
c.a.a
cba..
b.a..
b.a..
b.a..
b.a.a
b.a.a
ccb.a
b.bba
b..ba
cbaba
cba.a
cba.a
.a..a
.a.bc
..cbc
..c.c
..c.c
..ccc
b.ccc
c.ccc
caccc
baccc
bac.c
bac.c
bacaa
bacaa
bacaa
bacb.
bacaa
aacaa
a.caa
bccaa
bc.aa
bc.aa
bc..a
bc..a
bcc.a
bc..a
...aa
...aa
..caa
.a..a
.a.ba
.a..b
..ccb
...cb
.a.c.
.abcc
..abc
..abc
.ba.c
.b...
.b.b.
.b.b.
...c.
...c.
...c.
..bc.
..ac.
..ac.
..aa.
b.aa.
b..a.
bb.a.
ba.c.
b....
.....
.c...
cc.b.
cc.b.
.ca..
.ca..
cca..
cca.b
..abb
..b.a
..baa
.cbaa
..baa
...aa
.a.aa
baaaa
baaaa
bccaa
.ccab
.ccab
.baab
bba.b
bba.b
bba.b
bbaba
bc..a
bc..a
bc.aa
bc.aa
bbaaa
acb..
abb..
ab...
aacb.
a..b.
a..b.
abcb.
a.cb.
a.ca.
a.ca.
..cb.
..cba
.bb.a
.bbaa
.bbab
.c..b
.c...
.c...
.c...
.b...
.....
....a
....a
..a..
a....
a....
a....
a....
acb..
acb..
.c...
.....
.....
...c.
...ca
....c
....b
....c
..c.c
a.c..
a.ca.
a.b.a
aa..a
a..a.
a..c.
a..c.
c....
c....
c..cb
c..cb
...c.
b..cc
bbccc
bbccc
.ba.c
.abac
.aba.
.aba.
.aba.
aaca.
.acb.
..cb.
..cb.
.bcb.
..cb.
.bcb.
..cbb
..ca.
..cab
.ccab
accab
.cca.
